## 第11章 Web的攻击技术

### 11.1 针对Web的攻击技术

#### 11.1.3 针对Web应用的攻击模式

- 主动攻击：
  - SQL注入
  - OS命令注入
- 被动攻击：
  - XSS
  - 跨站点请求伪造



### 11.2 因输出值转义不完全引发的安全漏洞

实施Web应用的安全对策可大致分为：

- 客户端的验证
- Web应用端（服务器）的验证
  - 输入值验证
  - 输出值转义

当输出值转义不完全时，会因触发攻击者传入的攻击代码，而给输出对象带来损害。

#### 11.2.1 跨站脚本攻击（XSS）

通过存在安全漏洞的Web网站注册用户的浏览器内运行非法的HTML标签或 JS 进行的一种攻击。动态创建的HTML部分有可能隐藏着安全漏洞。

- 利用虚假输入表单骗取用户个人信息。
- 利用脚本窃取用户的Cookie值，被害者在不知情的情况下，帮助攻击者发送恶意请求。
- 现实伪造的文章或图片。

#### 11.2.2 SQL注入攻击

SQL注入是指针对Web应用使用的数据库，通过运行非法的SQL而产生的攻击。该安全隐患有可能直接导致个人信息及机密信息的泄露。

SQL注入攻击有可能会造成以下影响：

- 非法查看或篡改数据库内的数据
- 规避认证
- 执行和数据库服务器业务相关的程序

具体原理：在执行SQL语句时，部分内容依赖于前端请求中的字段，由于填写时引入了SQL中含有特殊意义的字符或命令，导致执行SQL语句后返回的结果与预期不符。

#### 11.2.3 OS命令注入攻击

通过Web应用，执行非法的操作系统命令达到攻击目的。通常通过对Shell的调用实现，常见于邮件系统中。

#### 11.2.4 HTTP首部注入攻击

通过在响应首部字段内插入换行，添加任意响应首部或主体的一种攻击。属于被动攻击模式。

HTTP首部注入攻击可能造成：

- 设置任何Cookie信息
- 重定向至任意URL
- 显示任意的主体（HTTP响应截断攻击）

#### 11.2.5 邮件首部注入攻击

攻击者通过向邮件首部 To 或 Subject 内任意添加非法内容发起的攻击。利用存在安全漏洞的Web网站，可对任意邮件地址发送广告邮件或病毒邮件。

#### 11.2.6 目录遍历攻击

对本无意公开的文件目录，通过非法截断其目录路径后，达成访问目的的一种攻击。

#### 11.2.7 远程文件包含漏洞

当部分脚本内容需要从其他文件读入时，攻击者利用指定外部服务器的URL充当依赖文件。主要是PHP存在的安全漏洞。



### 11.4 因会话管理疏忽引发的安全漏洞

#### 11.4.1 会话劫持

攻击者通过某种手段得到了用户的会话ID，并非法使用此会话ID伪装成用户，达到攻击的目的。

- 通过非正规的生成方法推测会话ID
- 通过窃听或XSS攻击盗取会话ID
- 通过会话固定攻击（Session Fixation）强行获取会话ID

#### 11.4.3 跨站点请求伪造（CSRF）

攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态更新，属于被动攻击。

- 利用已通过认证的用户权限更新设定信息
- 利用已通过认证的用户权限购买商品
- 利用已通过认证的用户权限在留言板上发表言论



### 11.5 其他安全漏洞

- 网络密码试错（穷举法、字典攻击）
- 已加密密码破解（穷举法、字典法类推；彩虹表；拿到密钥；加密算法漏洞）
- 点击劫持
- DoS攻击
- 后门程序