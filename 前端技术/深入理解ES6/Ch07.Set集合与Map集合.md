## 第七章 Set集合与Map集合

### ES6中的Set集合

#### 创建Set集合并添加元素

在Set中，不会对所存值进行强制的类型转换。如果向Set集合中添加多个对象，则它们之间彼此保持独立。

Set的`add()`方法和构造函数都会**过滤重复的值**来保证集合中的元素各自唯一。

#### 移除元素

`delete()`删除单个元素。

`clear()`清除整个Set的元素集。



### Set集合的forEach()方法

Set的`forEach()`与数组有一定差别，接受三个参数：

- Set集合中下一次索引的位置的值（value）
- 与第一个参数一样的值（index与value一样）
- 被遍历的Set集合本身



### 将Set集合转换为数组

如果需要进行索引式的访问，需要提前将Set转为数组：

- `array = [...set];`
- `array = Array.from(set);`



### Weak Set集合

Weak Set集合只存储对象的弱引用，并且不可以存储原始值；集合中的弱引用如果是对象唯一的引用（该对象已没有其他外部引用），则会被回收并释放相应内存。



### ES6中的Map集合

Map类型是一种存储着许多键值对的有序列表，其中的键名和对应的值支持所有的数据类型。键名的等价性判断是使用`Object.is()`来实现的。

- `set(key, value)`：用于添加一个元素，或覆盖同键元素
- `get(key)`：根据键名获取一个元素，若不存在则返回`undefined`
- `has(key)`：检测指定的键名在Map集合中是否已经存在
- `delete(key)`：从Map集合中移除指定键名及其对应的值
- `clear()`：清空 Map集合中所有键值对

#### 初始化方法

使用构造函数来构造，可以传入以`entries`形式构成的Array。也可以先创建一个空的Map，然后逐个使用`set()`来添加。

```JS
let map = new Map([
  ['key1', 'value1'], 
  ['key2', 'value2'],
]);
```



### Weak Map集合

Weak Map的键名必须是一个对象；集合中保存的是这些对象的弱引用；如果弱引用之外不存在其他其他的强引用，GC会自动回收这个对象，同时移除它在集合中的键值对。

**Weak Map最大的用途是保存Web页面中的DOM元素。**

#### 私有对象数据

ES5中的私有变量在构造函数中使用`var`声明，从而保证它只能在该作用域被访问，不会被外层作用域访问。

ES6中，可以在构造函数中声明一个Weak Map对象，用于存放私有数据。如果该对象实例被销毁，其相关信息也会被销毁。